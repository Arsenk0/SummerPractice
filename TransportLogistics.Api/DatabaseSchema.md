# Схема Бази Даних для Transport Logistics API

Дана схема описує основні сутності та їх зв'язки для системи управління транспортною логістикою. Використовується реляційна модель даних.

## 1. Таблиця `Users` (Користувачі)
* **Призначення:** Зберігання інформації про користувачів системи, необхідної для аутентифікації та авторизації.
* **Поля:**
    * `Id` (UUID/GUID) - Первинний ключ, унікальний ідентифікатор користувача.
    * `Email` (string, unique) - Електронна пошта користувача, використовується як логін.
    * `PasswordHash` (string) - Хеш пароля користувача.
    * `SecurityStamp` (string) - Використовується ASP.NET Identity для зміни пароля, логауту з усіх пристроїв.
    * `ConcurrencyStamp` (string) - Для оптимістичного паралелізму в ASP.NET Identity.
    * `PhoneNumber` (string, nullable) - Контактний номер телефону (опціонально).
    * `PhoneNumberConfirmed` (boolean) - Чи підтверджений номер телефону.
    * `EmailConfirmed` (boolean) - Чи підтверджена електронна пошта.
    * `TwoFactorEnabled` (boolean) - Чи увімкнена двофакторна аутентифікація.
    * `LockoutEnd` (DateTimeOffset, nullable) - Час закінчення блокування облікового запису.
    * `LockoutEnabled` (boolean) - Чи можливе блокування облікового запису.
    * `AccessFailedCount` (int) - Кількість невдалих спроб входу.
* **Зв'язки:**
    * Один-до-багатьох з `UserRoles` (через проміжну таблицю `AspNetUserRoles` в ASP.NET Identity).

## 2. Таблиця `Roles` (Ролі)
* **Призначення:** Зберігання визначених ролей користувачів у системі (наприклад, "Dispatcher", "Driver").
* **Поля:**
    * `Id` (UUID/GUID) - Первинний ключ, унікальний ідентифікатор ролі.
    * `Name` (string, unique) - Назва ролі (наприклад, "Dispatcher", "Driver").
    * `NormalizedName` (string, unique) - Нормалізована назва ролі (для пошуку без урахування регістру).
    * `ConcurrencyStamp` (string) - Для оптимістичного паралелізму.
* **Зв'язки:**
    * Один-до-багатьох з `UserRoles`.

## 3. Таблиця `Drivers` (Водії)
* **Призначення:** Зберігання основної інформації про водіїв.
* **Поля:**
    * `Id` (UUID/GUID) - Первинний ключ, унікальний ідентифікатор водія.
    * `FirstName` (string, required) - Ім'я водія.
    * `LastName` (string, required) - Прізвище водія.
    * `LicenseNumber` (string, unique, required) - Номер водійського посвідчення.
    * `ContactPhone` (string) - Контактний телефон водія.
    * `HireDate` (DateTime) - Дата прийому на роботу.
    * `IsAvailable` (boolean) - Чи доступний водій зараз.
    * `UserId` (UUID/GUID, unique, nullable) - Зовнішній ключ до таблиці `Users`. Може бути NULL, якщо водій ще не має облікового запису в системі.
* **Зв'язки:**
    * Один-до-одного з `Users` (через `UserId`).
    * Один-до-багатьох з `Routes` (один водій може мати багато маршрутів).

## 4. Таблиця `Vehicles` (Транспортні Засоби)
* **Призначення:** Зберігання інформації про транспортні засоби.
* **Поля:**
    * `Id` (UUID/GUID) - Первинний ключ, унікальний ідентифікатор ТЗ.
    * `LicensePlate` (string, unique, required) - Державний номерний знак.
    * `Make` (string, required) - Марка ТЗ (наприклад, "Volvo", "DAF").
    * `Model` (string, required) - Модель ТЗ.
    * `Year` (int) - Рік випуску.
    * `CapacityTons` (decimal) - Вантажопідйомність у тоннах.
    * `Status` (string) - Статус ТЗ (наприклад, "Available", "InUse", "Maintenance"). Можна реалізувати як Enum в коді.
* **Зв'язки:**
    * Один-до-багатьох з `Routes` (один ТЗ може використовуватися у багатьох маршрутах, але послідовно).

## 5. Таблиця `Routes` (Маршрути)
* **Призначення:** Зберігання інформації про заплановані або виконані маршрути.
* **Поля:**
    * `Id` (UUID/GUID) - Первинний ключ, унікальний ідентифікатор маршруту.
    * `RouteName` (string) - Назва маршруту (наприклад, "Київ - Львів").
    * `StartLocation` (string, required) - Початковий пункт маршруту.
    * `EndLocation` (string, required) - Кінцевий пункт маршруту.
    * `DepartureTime` (DateTimeOffset, required) - Час відправлення.
    * `ArrivalTime` (DateTimeOffset, nullable) - Очікуваний час прибуття (може бути NULL, якщо маршрут ще не завершено).
    * `Status` (string) - Статус маршруту (наприклад, "Planned", "InProgress", "Completed", "Cancelled").
    * `DriverId` (UUID/GUID, required) - Зовнішній ключ до таблиці `Drivers`.
    * `VehicleId` (UUID/GUID, required) - Зовнішній ключ до таблиці `Vehicles`.
* **Зв'язки:**
    * Багато-до-одного з `Drivers` (багато маршрутів до одного водія).
    * Багато-до-одного з `Vehicles` (багато маршрутів до одного ТЗ).

## 6. Проміжні таблиці ASP.NET Identity (генеруються автоматично)
* **`AspNetUserRoles`:** Зв'язує `Users` та `Roles` (багато-до-багатьох).
* **`AspNetUserClaims`:** Додаткові дані про користувача.
* **`AspNetUserLogins`:** Зовнішні логіни (Google, Facebook).
* **`AspNetUserTokens`:** Токени для користувачів.
* **`AspNetRoleClaims`:** Додаткові дані про ролі.

## Зв'язки між основними таблицями (пояснення):

* `Drivers.UserId` -> `Users.Id` (Один-до-одного: кожен водій може бути користувачем системи, але не кожен користувач є водієм)
* `Routes.DriverId` -> `Drivers.Id` (Багато-до-одного: багато маршрутів можуть бути призначені одному водію)
* `Routes.VehicleId` -> `Vehicles.Id` (Багато-до-одного: багато маршрутів можуть бути призначені одному транспортному засобу)